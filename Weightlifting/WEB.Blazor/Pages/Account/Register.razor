@page "/Account/Register"
@inject IAccountService _accountService;

<PageTitle>Register</PageTitle>

@if (!succeeded)
{
    <p>Please enter your details below.</p>

    <EditForm Model="@userRegistrationDTO" OnValidSubmit="@HandleValidSubmit">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="form-group">
            <label for="FirstName">First name</label>
            <InputText class="form-control" id="FirstName" @bind-Value="userRegistrationDTO.FirstName" placeholder="First name" />
        </div>

        <div class="form-group">
            <label for="Email">Email</label>
            <InputText class="form-control" id="Email" @bind-Value="userRegistrationDTO.Email" placeholder="Email" />
        </div>

        <div class="form-group">
            <label for="Password">Password</label>
            <InputText class="form-control" id="Password" @bind-Value="userRegistrationDTO.Password" placeholder="Password" />
        </div>

        <div class="form-group">
            <label for="ConfirmPassword">ConfirmPassword</label>
            <InputText class="form-control" id="ConfirmPassword" @bind-Value="userRegistrationDTO.ConfirmPassword" placeholder="Confirm password" />
        </div>

        <button class="btn btn-primary" type="submit">Submit</button>

    </EditForm>
}
else
{
    <p>
        Registration successful! <a href="Login">Click here to login</a>.
    </p>
}


@code {
    private UserRegistrationDTO userRegistrationDTO = new();
    private bool registering;
    private bool succeeded;

    private async Task HandleValidSubmit()
    {
        registering = true;

        var result = await _accountService.RegisterAthlete(userRegistrationDTO);

        if (result.Success)
        {
            succeeded = true;
        }

        registering = false;
    }
}